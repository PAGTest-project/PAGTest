[{"strategy": "retry", "code": "\npackage org.ice4j.message;\n\nimport static org.junit.jupiter.api.Assertions.*;\nimport org.ice4j.*;\nimport org.ice4j.attribute.*;\nimport org.junit.jupiter.api.*;\n\npublic class MessageFactory_addLongTermCredentialAttributesTest {\n\n    @Test\n    public void testAddLongTermCredentialAttributesSuccess() throws StunException {\n        Request request = new Request();\n        byte[] username = \"user\".getBytes();\n        byte[] realm = \"realm\".getBytes();\n        byte[] nonce = \"nonce\".getBytes();\n\n        MessageFactory.addLongTermCredentialAttributes(request, username, realm, nonce);\n\n        assertTrue(request.containsAttribute(Attribute.USERNAME));\n        assertTrue(request.containsAttribute(Attribute.REALM));\n        assertTrue(request.containsAttribute(Attribute.NONCE));\n        assertTrue(request.containsAttribute(Attribute.MESSAGE_INTEGRITY));\n    }\n\n    @Test\n    public void testAddLongTermCredentialAttributesUnsupportedEncoding() {\n        Request request = new Request();\n        byte[] username = {(byte) 0xFF, (byte) 0xFF, (byte) 0xFF, (byte) 0xFF}; // Invalid UTF-8 sequence\n        byte[] realm = \"realm\".getBytes();\n        byte[] nonce = \"nonce\".getBytes();\n\n        assertThrows(StunException.class, () -> {\n            MessageFactory.addLongTermCredentialAttributes(request, username, realm, nonce);\n        });\n    }\n}\n"}]