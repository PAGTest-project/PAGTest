[{"strategy": "retry", "code": "\npackage org.ice4j.stack;\n\nimport org.junit.jupiter.api.Test;\nimport org.mockito.Mockito;\n\nimport java.net.DatagramPacket;\nimport java.net.InetAddress;\nimport java.net.UnknownHostException;\n\nimport static org.mockito.Mockito.*;\n\npublic class StunStack_logPacketToPcapTest {\n\n    @Test\n    public void testLogPacketToPcap_LoggerEnabled_Sent() throws UnknownHostException {\n        // Given\n        DatagramPacket mockPacket = mock(DatagramPacket.class);\n        InetAddress mockInterfaceAddress = InetAddress.getByName(\"127.0.0.1\");\n        int interfacePort = 12345;\n        boolean isSent = true;\n\n        PacketLogger mockPacketLogger = mock(PacketLogger.class);\n        when(StunStack.isPacketLoggerEnabled()).thenReturn(true);\n        StunStack.packetLogger = mockPacketLogger;\n\n        when(mockPacket.getAddress()).thenReturn(mockInterfaceAddress);\n        when(mockPacket.getPort()).thenReturn(interfacePort);\n        when(mockPacket.getData()).thenReturn(new byte[0]);\n\n        // When\n        StunStack.logPacketToPcap(mockPacket, isSent, mockInterfaceAddress, interfacePort);\n\n        // Then\n        verify(mockPacketLogger).logPacket(\n                mockInterfaceAddress.getAddress(),\n                interfacePort,\n                mockInterfaceAddress.getAddress(),\n                interfacePort,\n                new byte[0],\n                isSent\n        );\n    }\n\n    @Test\n    public void testLogPacketToPcap_LoggerDisabled() throws UnknownHostException {\n        // Given\n        DatagramPacket mockPacket = mock(DatagramPacket.class);\n        InetAddress mockInterfaceAddress = InetAddress.getByName(\"127.0.0.1\");\n        int interfacePort = 12345;\n        boolean isSent = true;\n\n        when(StunStack.isPacketLoggerEnabled()).thenReturn(false);\n\n        // When\n        StunStack.logPacketToPcap(mockPacket, isSent, mockInterfaceAddress, interfacePort);\n\n        // Then\n        // No interaction with PacketLogger should occur\n        verifyNoInteractions(mockPacket);\n    }\n\n    @Test\n    public void testLogPacketToPcap_LoggerEnabled_NotSent() throws UnknownHostException {\n        // Given\n        DatagramPacket mockPacket = mock(DatagramPacket.class);\n        InetAddress mockInterfaceAddress = InetAddress.getByName(\"127.0.0.1\");\n        int interfacePort = 12345;\n        boolean isSent = false;\n\n        PacketLogger mockPacketLogger = mock(PacketLogger.class);\n        when(StunStack.isPacketLoggerEnabled()).thenReturn(true);\n        StunStack.packetLogger = mockPacketLogger;\n\n        when(mockPacket.getAddress()).thenReturn(mockInterfaceAddress);\n        when(mockPacket.getPort()).thenReturn(interfacePort);\n        when(mockPacket.getData()).thenReturn(new byte[0]);\n\n        // When\n        StunStack.logPacketToPcap(mockPacket, isSent, mockInterfaceAddress, interfacePort);\n\n        // Then\n        verify(mockPacketLogger).logPacket(\n                mockInterfaceAddress.getAddress(),\n                interfacePort,\n                mockInterfaceAddress.getAddress(),\n                interfacePort,\n                new byte[0],\n                isSent\n        );\n    }\n}\n"}]