[{"strategy": "retry", "code": "\npackage org.ice4j.stack;\n\nimport org.junit.jupiter.api.Test;\nimport org.mockito.Mockito;\n\nimport java.net.DatagramPacket;\nimport java.net.InetAddress;\nimport java.net.UnknownHostException;\n\nimport static org.mockito.Mockito.*;\n\npublic class StunStack_logPacketToPcapTest {\n\n    @Test\n    public void testLogPacketToPcap_PacketLoggerEnabled() throws UnknownHostException {\n        // Given\n        byte[] data = new byte[0];\n        DatagramPacket p = new DatagramPacket(data, data.length, InetAddress.getByName(\"192.168.1.1\"), 54321);\n        InetAddress interfaceAddress = InetAddress.getByName(\"127.0.0.1\");\n        int interfacePort = 12345;\n        boolean isSent = true;\n\n        PacketLogger packetLogger = mock(PacketLogger.class);\n        when(packetLogger.isEnabled()).thenReturn(true);\n        StunStack.setPacketLogger(packetLogger);\n\n        // When\n        StunStack.logPacketToPcap(p, isSent, interfaceAddress, interfacePort);\n\n        // Then\n        verify(packetLogger).logPacket(\n                interfaceAddress.getAddress(),\n                interfacePort,\n                p.getAddress().getAddress(),\n                p.getPort(),\n                p.getData(),\n                isSent\n        );\n    }\n\n    @Test\n    public void testLogPacketToPcap_PacketLoggerDisabled() throws UnknownHostException {\n        // Given\n        byte[] data = new byte[0];\n        DatagramPacket p = new DatagramPacket(data, data.length, InetAddress.getByName(\"192.168.1.1\"), 54321);\n        InetAddress interfaceAddress = InetAddress.getByName(\"127.0.0.1\");\n        int interfacePort = 12345;\n        boolean isSent = true;\n\n        PacketLogger packetLogger = mock(PacketLogger.class);\n        when(packetLogger.isEnabled()).thenReturn(false);\n        StunStack.setPacketLogger(packetLogger);\n\n        // When\n        StunStack.logPacketToPcap(p, isSent, interfaceAddress, interfacePort);\n\n        // Then\n        verify(packetLogger, never()).logPacket(any(), anyInt(), any(), anyInt(), any(), anyBoolean());\n    }\n\n    @Test\n    public void testLogPacketToPcap_InterfaceAddressNull() throws UnknownHostException {\n        // Given\n        byte[] data = new byte[0];\n        DatagramPacket p = new DatagramPacket(data, data.length, InetAddress.getByName(\"192.168.1.1\"), 54321);\n        InetAddress interfaceAddress = null;\n        int interfacePort = 12345;\n        boolean isSent = true;\n\n        PacketLogger packetLogger = mock(PacketLogger.class);\n        when(packetLogger.isEnabled()).thenReturn(true);\n        StunStack.setPacketLogger(packetLogger);\n\n        // When\n        StunStack.logPacketToPcap(p, isSent, interfaceAddress, interfacePort);\n\n        // Then\n        verify(packetLogger, never()).logPacket(any(), anyInt(), any(), anyInt(), any(), anyBoolean());\n    }\n}\n"}]